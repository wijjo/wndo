<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

<meta http-equiv="content-type" content="text/html;charset=utf-8" />

<title>Wndo help tutorial</title>

<style type="text/css">
* {
    font-size: 12pt;
}

.h1bar {
    background-color: #aaaaff;
    margin-top: 32px;
    margin-bottom: 12px;
    padding: 4px;
    width: 100%;
    height: auto;
    border-spacing: 0;
    border-collapse: collapse;
}

.h1barheading {
    font-size: 16pt;
    font-weight: bold;
    margin-top: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 4px;
}

.h1bartopcell {
    text-align: right;
}

.h1bartoplink {
    font-size: 11pt;
    text-indent: 1em;
    padding: 2px;
}

.h2bar {
    background-color: #e8e8ff;
    margin-top: 32px;
    margin-bottom: 12px;
    padding: 2px;
    width: 100%;
    height: auto;
    border-spacing: 0;
    border-collapse: collapse;
}

.h2barheading {
    font-size: 14pt;
    font-weight: bold;
    margin-top: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 2px;
}

.h2bartopcell {
    text-align: right;
}

.h2bartoplink {
    font-size: 11pt;
    text-indent: 1em;
    padding: 2px;
}

.heading1 {
    background-color: #aaaaff;
    font-size: 16pt;
    font-weight: bold;
    margin-top: 32px;
    margin-bottom: 12px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 4px;
}

.heading2 {
    background-color: #e8e8ff;
    font-size: 14pt;
    font-weight: bold;
    margin-top: 32px;
    margin-bottom: 12px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 2px;
}

.heading3 {
    border-bottom: 1px solid gray;
    width: auto;
    font-size: 13pt;
    font-weight: bold;
    margin-top: 24px;
    margin-bottom: 12px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 0;
}

.heading4 {
    font-size: 12pt;
    font-weight: bold;
    margin-top: 12px;
    margin-bottom: 6px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 0;
}

.heading5 {
    font-size: 12pt;
    font-weight: italic;
    margin-top: 8px;
    margin-bottom: 4px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 0;
}

.heading6 {
    font-size: 11pt;
    font-weight: italic;
    margin-top: 8px;
    margin-bottom: 4px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 0;
}

.gentable {
    border: 1px solid gray;
    margin-bottom: 8px;
    border-spacing: 0;
    border-collapse: collapse;
}

.genheader {
    border: 1px solid gray;
    background-color: #F2F2FF;
    padding: 2px 4px;
}

.genrow {
}

.gencell {
    border: 1px solid gray;
    padding: 2px 4px;
}

ol {
    margin-top: 0px;
    margin-bottom: 0px;
    margin-left: -8px;
    margin-right: 0px;
}

ol li {
    list-style-type: decimal;
}

ul li {
}

p {
    margin-top: 4px;
    margin-bottom: 4px;
    margin-left: 0px;
    margin-right: 0px;
    padding: 0;
}

pre {
    background-color: #eeeeee;
    font-size: 10pt;
}

.tocblock {
    border: 1px solid gray;
    background-color: #eeeeff;
    padding: 10px;
    margin: 20px;
}

.toc0 {
}

.toc1 {
    padding-top: 10px;
    font-weight: bold;
}

.toc2 {
    padding-left: 16px;
}

.toc3 {
    padding-left: 32px;
}

.toc4 {
    padding-left: 48px;
}

.block {
    padding-top: 6px;
    padding-bottom: 6px;
}
</style>

<style type="text/css" media="print">
.h1bartoplink {
    display: none;
}

.h2bartoplink {
    display: none;
}

.tocblock {
    display: none;
}

</style>

</head>

<body>

<h1 class="heading1">Tutorial</h1>
  <div id="toc" class="tocblock">
    <div class="toc1"><a href=#tocitem1>Quick Start</a></div>
      <div class="toc2"><a href=#tocitem2>Automatic Setup</a></div>
      <div class="toc2"><a href=#tocitem3>Manual Setup</a></div>
      <div class="toc2"><a href=#tocitem4>Multiple Screen Setup</a></div>
      <div class="toc2"><a href=#tocitem5>Finishing Up</a></div>
      <div class="toc2"><a href=#tocitem6>Finishing Up</a></div>
    <div class="toc1"><a href=#tocitem7>Setting Workspace Wallpaper</a></div>
    <div class="toc1"><a href=#tocitem8>Using Random Workspace Wallpaper</a></div>
    <div class="toc1"><a href=#tocitem9>Using Window Alignment</a></div>
      <div class="toc2"><a href=#tocitem10>Default Key Bindings</a></div>
      <div class="toc2"><a href=#tocitem11>Command Line</a></div>
    <div class="toc1"><a href=#tocitem12>Using Window Tiling</a></div>
      <div class="toc2"><a href=#tocitem13>Default Key Bindings</a></div>
      <div class="toc2"><a href=#tocitem14>Command Line</a></div>
      <div class="toc2"><a href=#tocitem15>Notes</a></div>
    <div class="toc1"><a href=#tocitem16>Starting and Stopping Applications</a></div>
      <div class="toc2"><a href=#tocitem17>Starting in the Current Workspace</a></div>
      <div class="toc2"><a href=#tocitem18>Starting in Another Workspace</a></div>
      <div class="toc2"><a href=#tocitem19>Starting if not Already Running</a></div>
      <div class="toc2"><a href=#tocitem20>Killing Applications</a></div>
    <div class="toc1"><a href=#tocitem21>Accessing Help Documentation</a></div>
      <div class="toc2"><a href=#tocitem22>Help on Help</a></div>
      <div class="toc2"><a href=#tocitem23>Topic Help</a></div>
    <div class="toc1"><a href=#tocitem24>Developing a Simple Extension</a></div>
      <div class="toc2"><a href=#tocitem25>Introduction</a></div>
      <div class="toc2"><a href=#tocitem26>Creating the Script File</a></div>
      <div class="toc2"><a href=#tocitem27>Initialization - Configuration File and Globals</a></div>
      <div class="toc2"><a href=#tocitem28>CMDO and WNDO Namespaces</a></div>
      <div class="toc2"><a href=#tocitem29>Saving the METAR Station - the "set" Function</a></div>
      <div class="toc2"><a href=#tocitem30>Displaying the Temperature - the "show" Function</a></div>
      <div class="toc2"><a href=#tocitem31>The Complete Code</a></div>
      <div class="toc2"><a href=#tocitem32>Testing Your Module</a></div>
  </div>
  <span id="tocitem1">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Quick Start</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem2">
    <h3 class="heading3">Automatic Setup</h3>
      <div class="block">
      Automatic setup activates and configures Wndo for a user by performing
      these two functions.
      </div>
      <ul>
        <li>
        Adds Wndo-spy as an autostart program.
        </li>
        <li>
        Binds workspace events based on user preferences.
        </li>
        <li>
        Binds keys to various functions based on user preferences.
        </li>
      </ul>
      <div class="block">
      By default the following functionality is enabled.
      </div>
      <ul>
        <li>
        All possible keys are bound to all available features.
        </li>
        <li>
        Direct keys (with no prefix) provide one keystroke access.
        </li>
        <li>
        Each workspace gets its own wallpaper.
        </li>
        <li>
        Randomized wallpaper is changed every 20 minutes.
        </li>
      </ul>
      <div class="block">
      The following command activates a user with the defaults.
      </div>
<pre>
wndo setup.activate</pre>

      <div class="block">
      Other setup options are available. Run the following to see the
      possibilities.
      </div>
<pre>
wndo help setup.activate</pre>

      <div class="block">
      For primitive prompting for each setup.activate option use this command.
      </div>
<pre>
wndo prompt setup.activate</pre>

      <div class="block">
      To substitute a 5 minute random wallpaper changing interval use:
      </div>
<pre>
wndo prompt setup.activate interval=5</pre>

      <div class="block">
      To disable random wallpaper changing interval use:
      </div>
<pre>
wndo prompt setup.activate interval=0</pre>

      <div class="block">
      Xfce environments require a special tweak in order to hook into its
      wallpaper management scheme. A Wndo-managed backdrop list substitutes for
      whatever image or backdrop list was being used. Your current image choice
      will be preserved by activation.
      </div>
      <div class="block">
      See "Setting Workspace Wallpaper" below for specifics on managing
      wallpaper selections.
      </div>
    </span>
    <span id="tocitem3">
    <h3 class="heading3">Manual Setup</h3>
      <div class="block">
      Add wndo-spy to the autostart programs. In Fluxbox you can add the
      following line to "~/.fluxbox/startup".
      </div>
<pre>
wndo-spy &amp;</pre>

      <div class="block">
      In an XDG-compatible window manager like Gnome or Xfce you can simply add
      "wndo-spy" to the autostart programs through the Autostart settings panel.
      The location of this panel may vary for different window managers,
      versions and distributions.
      </div>
      <div class="block">
      Adding event bindings is much more tedious, requiring a separate Wndo
      command for each binding. For this reason the automatic setup is highly
      recommended, and safe. The only slightly complex change is for Xfce
      wallpapers and backups are maintained.
      </div>
    </span>
    <span id="tocitem4">
    <h3 class="heading3">Multiple Screen Setup</h3>
      <div class="block">
      If you have more than one screen you need one instance of wndo-spy
      assigned to each screen. You also need to initialize the wallpaper for
      each screen by specifying the display. For example, the lines in
      "~/.fluxbox/startup" for a two screen setup might look like this.
      </div>
<pre>
wndo-spy -d :0.0 &amp;
wndo-spy -d :0.1 &amp;</pre>

      <div class="block">
      Similar commmands may be used in the Gnome or Xfce autostart list (without
      the "&amp;").
      </div>
      <div class="block">
      Each screen is assigned its own X display id, e.g. ":0.0" and ":0.1" for
      two screens. Each screen needs its own instance of wndo-spy started with
      the appropriate display id passed to the "-d" option. Each wndo-spy
      instance only triggers events for its assigned screen, and events are
      processed by Wndo in the context of that display. So wallpaper changes
      triggered on screen N change the wallpaper on screen N.
      </div>
    </span>
    <span id="tocitem5">
    <h3 class="heading3">Finishing Up</h3>
      <div class="block">
      Completely exit Fluxbox and log in again. Verify proper installation by
      following the instructions in Setting Workspace Wallpaper or by trying
      some of the default key bindings (documented in README).
      </div>
    </span>
    <span id="tocitem6">
    <h3 class="heading3">Finishing Up</h3>
      <div class="block">
      Completely exit the window manager and log in again. Verify proper
      installation by following the instructions in Setting Workspace Wallpaper
      or by trying some of the default key bindings (documented in README).
      </div>
    </span>
  </span>
  <span id="tocitem7">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Setting Workspace Wallpaper</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <div class="block">
    Visit each workspace in turn (e.g. by using the default [Control-Alt-Right]
    key binding).
    </div>
    <div class="block">
    Select a wallpaper image. From the command line you can use the following
    command.
    </div>
<pre>
wndo wallpaper.set /path/to/image</pre>

    <div class="block">
    Or if zenity is installed, you can use either the default key binding of
    [Super-Keypad*] ([Windows-Keypad*]) or the following command to choose a
    wallpaper image with a file selection dialog. Note that you can only choose
    specific images, not directories for random selections.
    </div>
<pre>
wndo wallpaper.select</pre>

    <div class="block">
    The wallpaper selections for each workspace should be saved and reloaded
    each time you visit a workspace.
    </div>
  </span>
  <span id="tocitem8">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Using Random Workspace Wallpaper</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <div class="block">
    To set random wallpaper for a workspace choose a directory, rather than a
    single file, for example:
    </div>
<pre>
wndo wallpaper.set /path/to/directory</pre>

    <div class="block">
    The image will be randomly selected from that directory from all files with
    supported image file extensions. The randomly-selected wallpaper will not
    change unless you either force it to change or use a timed heartbeat to
    change it.
    </div>
    <div class="block">
    Note that random wallpaper directory selection has no GUI alternative to the
    command line. Zenity does not support a directory selection dialog.
    </div>
    <div class="block">
    To force a change use either the default key binding [Super-Keypad/]
    ([Windows-Keypad/]) or the the following command from the command line (or a
    menu item).
    </div>
<pre>
wndo wallpaper.apply randomize=yes</pre>

    <div class="block">
    The wallpaper.apply command will not choose another image without the
    randomize option. It will just reload the previous one.
    </div>
    <div class="block">
    To change it every 20 minutes add an event binding as follows.
    </div>
<pre>
wndo events.add timer20 "wallpaper.apply randomize=yes"</pre>

    <div class="block">
    Substitute "timer1", "timer5", or "timer60" in the binding for "timer20" to
    get 1, 5, or 60 minute intervals. For now, these are the only intervals
    possible without wrapping the command in conditional Python logic.
    </div>
    <div class="block">
    Wallpaper randomization also supports a primitive rating system to increase
    or decrease the chance of seeing a particular image. The default key
    bindings are [Super-Keypad+] or [Super-Keypad-] ([Windows-Keypad+] or
    [Windows-Keypad-]) to increase or decrease the current image's rating. If
    the "osd_cat" program is available you will briefly see the image and rating
    on the screen when you change it. When a rating falls below zero it disables
    the image. For now, to reenable an image you would need to edit
    ~/.wndo/wallpaper.conf.
    </div>
  </span>
  <span id="tocitem9">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Using Window Alignment</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem10">
    <h3 class="heading3">Default Key Bindings</h3>
      <div class="block">
      The alignment function and bindings move windows (without resizing) to the
      screen edges, corners or center. Positions are visualized in the grid
      below, along with the default keypad bindings (grid #'s are in
      parentheses).
      </div>
      <div class="block">
      Notice the relationship between keypad and screen geometries. Also note
      that it's relative positions that relate, rather than the numbers on the
      keys. All bound key combinations use the [Super] key modifier (the
      [Windows] key).
      </div>
      <div class="block">
      All default bindings, including those shown below, are listed in the
      README Key Bindings section. Try them out on a window!
      </div>
<pre>
            Screen                              Keypad
1---------+----2----+---------3     +---------+---------+---------+
|         |         |         |     |    7    |    8    |    9    |
|         |         |         |     |  Home   |   Up    |  PgUp   |
|         |         |         |     |   (1)   |   (2)   |   (3)   |
+---------+---------+---------+     +---------+---------+---------+
|         |         |         |     |    4    |    5    |    6    |
4         |    5    |         6     |  Left   |         |  Right  |
|         |         |         |     |   (4)   |   (5)   |   (6)   |
+---------+---------+---------+     +---------+---------+---------+
|         |         |         |     |    1    |    2    |    3    |
|         |         |         |     |   End   |  Down   |  PgDn   |
|         |         |         |     |   (7)   |   (8)   |   (9)   |
7---------+----8----+---------9     +---------+---------+---------+
                            (add [Super] or [Windows] key modifiers)</pre>

    </span>
    <span id="tocitem11">
    <h3 class="heading3">Command Line</h3>
      <div class="block">
      A single position # argument passed to the window.align function
      determines the screen position for the window. For example, this command
      moves the active window to the top left corner.
      </div>
<pre>
wndo window.align 1</pre>

      <div class="block">
      This command moves the active window to the middle of the screen.
      </div>
<pre>
wndo window.align 5</pre>

      <div class="block">
      Similar to other window functions, window.align takes an optional window
      argument, "w". It can be a hex window id, a call to a window-seeking
      function, or the value "pick" to select a target window with the mouse.
      The following command moves a window you choose with the mouse to the
      right side of the screen.
      </div>
<pre>
wndo window.align 6 w=pick</pre>

    </span>
  </span>
  <span id="tocitem12">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Using Window Tiling</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem13">
    <h3 class="heading3">Default Key Bindings</h3>
      <div class="block">
      Tiling resizes and moves windows to fill a set of virtual screen zones.
      The asymmetrical tiling zone grid and default keypad bindings, with
      covered tile numbers in parentheses, are shown below.
      </div>
      <div class="block">
      The pattern maps corner keys to corner rectangles, keys between corners to
      entire screen edges, and the middle key to the full screen. Default
      bindings use the [Super-Shift] modifiers ([Super] is the [Windows] key).
      E.g. [Super-Shift-KP_Left] means to press [Windows], [Shift] and the
      keypad cursor left key (number 4).
      </div>
      <div class="block">
      All bindings, including those shown below, are listed in the README Key
      Bindings section. Try them out on a window!
      </div>
<pre>
            Screen                              Keypad
+-------------------+---------+     +---------+---------+---------+
|                   |         |     |    7    |    8    |    9    |
|                   |         |     |  Home   |   Up    |  PgUp   |
|                   |         |     |   (1)   |  (1,2)  |   (2)   |
|         1         |    2    |     +---------+---------+---------+
|                   |         |     |    4    |    5    |    6    |
|                   |         |     |  Left   |         |  Right  |
|                   |         |     |  (1,3)  |(1,2,3,4)|  (2,4)  |
+-------------------+---------+     +---------+---------+---------+
|                   |         |     |    1    |    2    |    3    |
|         3         |    4    |     |   End   |  Down   |  PgDn   |
|                   |         |     |   (3)   |  (3,4)  |   (4)   |
+-------------------+---------+     +---------+---------+---------+
                (add [Super-Shift] or [Windows-Shift] key modifiers)</pre>

    </span>
    <span id="tocitem14">
    <h3 class="heading3">Command Line</h3>
      <div class="block">
      One or two tile # arguments passed to the window.tile function determine
      the screen rectangle assigned to the window. For example, this command
      fills the left side of the screen from top to bottom with the active
      window.
      </div>
<pre>
wndo window.tile 1 3</pre>

      <div class="block">
      This command fills the small rectangle in the bottom right corner with the
      active window.
      </div>
<pre>
wndo window.tile 4</pre>

      <div class="block">
      This command fills the screen with the active window.
      </div>
<pre>
wndo window.tile 1 4</pre>

      <div class="block">
      Similar to other window functions, window.tile takes an optional window
      argument, "w". It can be assigned a hex window id or the value "pick" to
      select a window with the mouse. The following command maximizes a window
      you choose by clicking with the mouse.
      </div>
<pre>
wndo window.tile 1 4 w=pick</pre>

    </span>
    <span id="tocitem15">
    <h3 class="heading3">Notes</h3>
      <div class="block">
      The limited functionality is a compromise to support simple scenarios,
      while allowing a small set of intuitive and useful key bindings. Common
      scenarios include situations where a major window, like a browser or
      editor, is accompanied by one or two smaller tool windows, like a
      calculator. Future releases will evolve more sophistication as it becomes
      obvious what people want.
      </div>
    </span>
  </span>
  <span id="tocitem16">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Starting and Stopping Applications</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem17">
    <h3 class="heading3">Starting in the Current Workspace</h3>
<pre>
wndo run.here xterm</pre>

      <div class="block">
      Runs xterm in the current workspace. This function is primarily useful for
      custom key bindings to system commands.
      </div>
    </span>
    <span id="tocitem18">
    <h3 class="heading3">Starting in Another Workspace</h3>
<pre>
wndo run.there xterm next</pre>

      <div class="block">
      Runs xterm in the next workspace.
      </div>
<pre>
wndo run.there xterm 3</pre>

      <div class="block">
      Runs xterm in workspace #3.
      </div>
    </span>
    <span id="tocitem19">
    <h3 class="heading3">Starting if not Already Running</h3>
<pre>
wndo run.once xterm cls=xterm ws=3</pre>

      <div class="block">
      Runs xterm in workspace 3 if it's not already running in that workspace.
      </div>
      <div class="block">
      To run Firefox in workspace 2 the first time you enter the workspace, and
      any time you reenter with it not running, add the following event binding.
      </div>
<pre>
wndo events.add workspace2 "run.once firefox cls=firefox-bin ws=2"</pre>

      <div class="block">
      Wndo-spy invokes "events.handle" with the "workspace2" event upon arrival
      in workspace #2. The "cls=firefox-bin" argument identifies a Firefox
      window by its WM_CLASS property.
      </div>
    </span>
    <span id="tocitem20">
    <h3 class="heading3">Killing Applications</h3>
      <div class="block">
      To kill an application by clicking on a window run the following command
      or use the default Super-KP_Delete key binding (Windows-Keypad-Delete).
      </div>
<pre>
wndo run.killwindow w=pick</pre>

      <div class="block">
      Use the following to kill all running xterm's.
      </div>
<pre>
wndo run.killwindow cls=xterm</pre>

      <div class="block">
      The following command violently kills all applications with window titles
      containing the text "Nasty Virus".
      </div>
<pre>
wndo run.killwindow sig=kill title="Nasty Virus"</pre>

    </span>
  </span>
  <span id="tocitem21">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Accessing Help Documentation</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem22">
    <h3 class="heading3">Help on Help</h3>
      <div class="block">
      Running "wndo" by itself or the following command will display a list of
      available help topics, including major topics, such as modules, functions,
      and other keywords.
      </div>
<pre>
wndo help</pre>

      <div class="block">
      Help on the "help" command/function is available.
      </div>
<pre>
wndo help help</pre>

    </span>
    <span id="tocitem23">
    <h3 class="heading3">Topic Help</h3>
      <div class="block">
      As you can see there's a great deal of flexibility available for finding
      and presenting help. The keywords search for and load multiple help topics
      based on keywords embedded in the documentation. This tutorial is
      available via the command.
      </div>
<pre>
wndo help tutorial</pre>

      <div class="block">
      If you want a complete reference to all functions in html format run the
      following.
      </div>
<pre>
wndo help reference format=html output=ref.html</pre>

    </span>
  </span>
  <span id="tocitem24">
  <table class="h2bar"><tr><td><h2 class="h2barheading">Developing a Simple Extension</h2></td><td class="h2bartopcell"><a href="#toc" class="h2bartoplink">Top</a></td></tr></table>
    <span id="tocitem25">
    <h3 class="heading3">Introduction</h3>
      <div class="block">
      Let's say you know a little about writing Python scripts, and you want to
      add some new features to Wndo. Specifically, you'd like to periodically
      display the current temperature. This section will walk you through the
      steps and present the code a block at a time. For now this tutorial and
      actual module code are the best developer resources, until developer
      reference and guide books exist.
      </div>
    </span>
    <span id="tocitem26">
    <h3 class="heading3">Creating the Script File</h3>
      <div class="block">
      You just need one file with a ".cmdo" extension placed in one of a few
      supported places ending in a wndo.d subdirectory. Determine the list of
      possible directories by running the following command.
      </div>
<pre>
wndo 'print CMDO.program.dirsScript'</pre>

      <div class="block">
      For this example create the module script file as
      "~/.wndo/wndo.d/weather.cmdo" to avoid potential permission issues with
      system directories. Load the file into your favorite text editor.
      </div>
      <div class="block">
      The first line we'll add coaxes the editor into recognizing it as a Python
      file for syntax highlighting. You may need to reload or refresh to see a
      visible effect. While this in theory allows shell execution, running
      directly from the shell won't work due to special symbols only available
      when loaded by Wndo. We'll throw in a comment for good measure.
      </div>
<pre>
#!/usr/bin/env python
# My first Wndo extension for showing the temperature!</pre>

    </span>
    <span id="tocitem27">
    <h3 class="heading3">Initialization - Configuration File and Globals</h3>
      <div class="block">
      We need to import the "re" module for regular expression parsing of METAR
      data and the "urllib" module to download the data file.
      </div>
<pre>
import re
import urllib</pre>

      <div class="block">
      Saving the METAR station in a file eliminates the need to specify it each
      time the temperature is displayed. Configuration files are simple to use
      via a get/set API. Here we create a configuration access object. When the
      first data is saved the file "~/.wndo/weather.conf" will appear. It uses
      standard Python ConfigParser (INI file) format.
      </div>
<pre>
config = CMDO.config('weather')</pre>

    </span>
    <span id="tocitem28">
    <h3 class="heading3">CMDO and WNDO Namespaces</h3>
      <div class="block">
      The runtime engine injects two special namespaces into the global symbols
      visible to modules, CMDO and WNDO. The former exposes the core engine's
      public variables, classes and functions. The latter similarly exposes
      application symbols. We already used this from the command line to display
      the module directory list.
      </div>
      <div class="block">
      The only other global variable needed is the URL template for accessing
      METAR data. The station code will be injected before using the URL.
      </div>
<pre>
url = 'http://weather.noaa.gov/pub/data/observations/metar/stations/%s.TXT'</pre>

    </span>
    <span id="tocitem29">
    <h3 class="heading3">Saving the METAR Station - the "set" Function</h3>
      <div class="block">
      Okay, here's where it gets a little unfamiliar. The Cmdo engine relies on
      "decorators" to declare functions available externally, i.e. from the
      command line. Decorators are a relatively new Python feature to support
      adding meta-data to function declarations. The "@CMDO.export" decorator
      both flags the function as externally visible and specifies argument types
      for validation and conversion. For simplicity this example avoids extended
      capabilities, like custom types, and optional or keyword arguments. The
      decorator also feeds into the help system, along with the "doc string" at
      the top of the function code.
      </div>
      <div class="block">
      The following code declares the exported function and its one string
      argument, documents the argument and function, and implements saving to
      the configuration file. Note that set() takes a sction name, option name
      and the value and save() is required to write the data.
      </div>
<pre>
@CMDO.export(CMDO.String(desc='METAR station'))
def set(station):
    'Set METAR station (see http://www.nws.noaa.gov/tg/siteloc.shtml).'
    config.set('location', 'station', station)
    config.save()</pre>

      <div class="block">
      You can now see your new module and function on the command line using the
      command "wndo help". The "weather" module should appear in the "Major
      Topics" list and "weather.set" should appear under "Functions". "wndo help
      weather" should show detailed help for the new module. A syntax error
      should show enough context to help you fix it.
      </div>
    </span>
    <span id="tocitem30">
    <h3 class="heading3">Displaying the Temperature - the "show" Function</h3>
      <div class="block">
      This function is simpler to declare, having no arguments, but more
      complicated to implement, given the need to access and parse METAR data on
      the Internet. Since the tutorial is more concerned about how to build a
      module, the implementation details concerning downloading and parsing
      won't be explained. It's simplistic, but should work in the U.S.. Similar
      code for other countries should be readily available. To test it just pick
      a random META code, e.g. KVUO, and it should work from anywhere.
      </div>
      <div class="block">
      Note that the export decorator can appear without parentheses when no
      arguments are declared. The function starts by reading the station from
      the configuration file using config.get(). Then it fills out the URL and
      downloads and parses the data to calculate the temperature. Finally it
      displays the temperature on screen by invoking another Wndo function.
      </div>
<pre>
@CMDO.export
def show():
    'Display current weather'
    station = config.get('location', 'station')
    reParse = re.compile('^%s [^ ]+ (AUTO)? [^ ]+ [^ ]+ [^ ]+ (M)?([0-9]+)/.*$' \
% station)
    for line in urllib.urlopen(url % station):
        m = reParse.match(line.strip())
        if m is not None:
            # Display farenheit temp. in top-left corner for 5 seconds.
            if m.group(2) and m.group(2) == 'M':
                temp = -int(m.group(3)) * 9 / 5 + 32
            else:
                temp = int(m.group(3)) * 9 / 5 + 32
            WNDO.osd.display(str(temp), alignment=1, color='cyan', duration=5)
            break</pre>

    </span>
    <span id="tocitem31">
    <h3 class="heading3">The Complete Code</h3>
<pre>
#!/usr/bin/env python
# My first Wndo extension for showing the temperature!

import re
import urllib

config = cmdo.config('weather')
url = 'http://weather.noaa.gov/pub/data/observations/metar/stations/%s.TXT'

@CMDO.export(CMDO.String(desc='METAR station'))
def set(station):
    'Set METAR station (see http://www.nws.noaa.gov/tg/siteloc.shtml).'
    config.set('location', 'station', station)
    config.save()

@CMDO.export
def show():
    'Display current weather'
    station = config.get('location', 'station')
    reParse = re.compile('^%s [^ ]+ (AUTO)? [^ ]+ [^ ]+ [^ ]+ (M)?([0-9]+)/.*$' \
% station)
    for line in urllib.urlopen(url % station):
        m = reParse.match(line.strip())
        if m is not None:
            # Display farenheit temp. in top-left corner for 5 seconds.
            if m.group(2) and m.group(2) == 'M':
                temp = -int(m.group(3)) * 9 / 5 + 32
            else:
                temp = int(m.group(3)) * 9 / 5 + 32
            WNDO.osd.display(str(temp), alignment=1, color='cyan', duration=5)
            break</pre>

      <div class="block">
      Not too bad, considering you get a command line interface, argument
      checking, on-demand loading, multi-format help, bash completion, and
      access to a function library almost for free!
      </div>
    </span>
    <span id="tocitem32">
    <h3 class="heading3">Testing Your Module</h3>
      <div class="block">
      Try getting module help. You should see complete information for the
      module and both functions.
      </div>
<pre>
wndo help weather</pre>

      <div class="block">
      Should display this.
      </div>
<pre>
===== Wndo help weather =====


=== Function: weather.set ===

Set METAR station (see http://www.nws.noaa.gov/tg/siteloc.shtml).

= Ordered Arguments =

1: METAR station


=== Function: weather.show ===

Display current weather</pre>

      <div class="block">
      The next command formats help as HTML and loads it in your browser based
      on mime type assignments.
      </div>
<pre>
wndo help weather format=html view=yes</pre>

      <div class="block">
      Supported formats are "text" (the default), "html" and "xml".
      </div>
      <div class="block">
      Now configure the METAR station. Go to the
        <a href="http://www.nws.noaa.gov/tg/siteloc.shtml">NOAA site</a>
        to find you station id (4 letter code) and run this command.
      </div>
<pre>
wndo weather.set &lt;4 letter code&gt;</pre>

      <div class="block">
      Verify that you now have a file "~/.wndo/weather.conf" and that it
      contains something like this.
      </div>
<pre>
[location]
station = &lt;4 letter code&gt;</pre>

      <div class="block">
      Manually display the temperature using this command.
      </div>
<pre>
wndo weather.show</pre>

      <div class="block">
      Display the temperature every hour by adding an event binding to
      "timer60", the 60 minute heartbeat event from wndo-spy, e.g.
      </div>
<pre>
wndo events.add timer60 weather.show</pre>

    </span>
  </span>

</body>
</html>
